[gd_scene load_steps=29 format=3 uid="uid://cegpaop1o2now"]

[ext_resource type="PackedScene" uid="uid://dxfb2g85u3t6m" path="res://Game Objects/Actors/Players/Player.tscn" id="1"]
[ext_resource type="Script" path="res://Scripts/Actors/Player/Rose/rose_action_instancer.gd" id="2_rv5x2"]
[ext_resource type="Script" path="res://Scripts/Actors/Player/crouch_state.gd" id="3_7ptux"]
[ext_resource type="Shader" path="res://Resources/Shaders/MultCelShader.gdshader" id="4_ahpf3"]
[ext_resource type="AnimationLibrary" uid="uid://bt2jl0ipha4it" path="res://Resources/Entities/Actors/Players/Rose/RoseAnimations.res" id="8_r86g7"]
[ext_resource type="Texture2D" uid="uid://bifaogk4jg48m" path="res://Assets/Sprites/Actors/Rose/Movement/Dodge.png" id="11"]
[ext_resource type="Script" path="res://Scripts/Actors/Player/wind.gd" id="13"]
[ext_resource type="Texture2D" uid="uid://b6lh1k3wtq7fq" path="res://Assets/Sprites/Actors/Rose/Movement/Idle_Spec.png" id="21_ug53m"]
[ext_resource type="Texture2D" uid="uid://mog5dtp25i81" path="res://Assets/Sprites/Actors/Rose/Movement/Dodge_n.png" id="25"]
[ext_resource type="Script" path="res://Scripts/Actors/Player/targetting.gd" id="27_rf1x6"]
[ext_resource type="Texture2D" uid="uid://cehmun2ra418y" path="res://Assets/Sprites/Actors/Rose/cape_shadow.png" id="28_ulm3k"]
[ext_resource type="Script" path="res://Scripts/Actors/audio_handler.gd" id="59_i7kba"]
[ext_resource type="AudioStream" uid="uid://cuglsobpo2cvn" path="res://Assets/sfx/footsteps/dirt_small_01.wav" id="60_476h5"]
[ext_resource type="AudioStream" uid="uid://dgfurii7q3eyx" path="res://Assets/sfx/footsteps/dirt_small_02.wav" id="61_dobde"]
[ext_resource type="AudioStream" uid="uid://c7phaa4uvy2h3" path="res://Assets/sfx/footsteps/dirt_small_03.wav" id="62_83mud"]
[ext_resource type="AudioStream" uid="uid://bny6fj3er18qr" path="res://Assets/sfx/footsteps/dirt_small_04.wav" id="63_j4ffd"]
[ext_resource type="AudioStream" uid="uid://c1lo4gdyhfg02" path="res://Assets/sfx/footsteps/grass_01.wav" id="64_i7s0s"]
[ext_resource type="AudioStream" uid="uid://cpk7dqj0ovakm" path="res://Assets/sfx/footsteps/grass_02.wav" id="65_3ctk1"]
[ext_resource type="AudioStream" uid="uid://cyab4hixfrxc1" path="res://Assets/sfx/footsteps/grass_03.wav" id="66_x5aat"]
[ext_resource type="AudioStream" uid="uid://drri6vmtj1742" path="res://Assets/sfx/slide/dirt_small_01.wav" id="67_0lnn5"]
[ext_resource type="AudioStream" uid="uid://dfn5j6u585yl1" path="res://Assets/sfx/footsteps/grass_04.wav" id="67_4crhy"]
[ext_resource type="AudioStream" uid="uid://fdvxcj1uqp4o" path="res://Assets/sfx/slide/dirt_small_02.wav" id="68_bsyx1"]
[ext_resource type="AudioStream" uid="uid://ckkg8vn7nye6e" path="res://Assets/sfx/slide/dirt_small_03.wav" id="69_f7myh"]
[ext_resource type="AudioStream" uid="uid://c3wxn1y7g27gs" path="res://Assets/sfx/slide/dirt_small_04.wav" id="70_hi1u4"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_hehew"]
size = Vector2(20, 16)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_2qgdc"]
shader = ExtResource("4_ahpf3")
shader_parameter/cameraPosition = Vector3(0, 0, 0)
shader_parameter/lightColorFac = 0.1
shader_parameter/lightAdd = -0.2
shader_parameter/shadowSubtract = 0.5
shader_parameter/unlitColorMix = Color(0.12549, 0.054902, 0.0627451, 1)
shader_parameter/unlitColorControl = 0.5
shader_parameter/theta = 0.0
shader_parameter/darkArea = Color(1, 0, 0, 1)
shader_parameter/segmentation = 1.0

[sub_resource type="CanvasTexture" id="CanvasTexture_acfie"]
diffuse_texture = ExtResource("11")
normal_texture = ExtResource("25")
specular_texture = ExtResource("21_ug53m")

[sub_resource type="RectangleShape2D" id="RectangleShape2D_3m3ny"]
size = Vector2(480, 270)

[node name="Rose" groups=["Persist"] instance=ExtResource("1")]
position = Vector2(-1, 3)
collision_layer = 4
move_states = {
"action": NodePath("MoveStates/Action"),
"crouch": NodePath("MoveStates/Crouch"),
"hit": NodePath("MoveStates/Hit"),
"ledge_grab": NodePath("MoveStates/LedgeGrab"),
"move_in_air": NodePath("MoveStates/MoveInAir"),
"move_on_ground": NodePath("MoveStates/MoveOnGround")
}
iframe = true

[node name="CrouchBox" type="CollisionShape2D" parent="." index="0"]
position = Vector2(0, 11)
shape = SubResource("RectangleShape2D_hehew")

[node name="MoveOnGround" parent="MoveStates" index="0"]
open_cast_l_path = NodePath("../../Utilities/OpenCrouchCastL")
open_cast_r_path = NodePath("../../Utilities/OpenCrouchCastR")

[node name="LookTimer" type="Timer" parent="MoveStates/MoveOnGround" index="0"]
wait_time = 0.25
one_shot = true

[node name="Action" parent="MoveStates" index="4"]
use_default_movement = false

[node name="ActionController" parent="MoveStates/Action" index="0"]
action_can_interrupt = true

[node name="ActionInstancer" parent="MoveStates/Action/ActionController" index="0"]
script = ExtResource("2_rv5x2")

[node name="Crouch" type="Node2D" parent="MoveStates" index="6"]
script = ExtResource("3_7ptux")
open_cast_l_path = NodePath("../../Utilities/OpenCrouchCastL")
open_cast_r_path = NodePath("../../Utilities/OpenCrouchCastR")

[node name="LookTimer" type="Timer" parent="MoveStates/Crouch" index="0"]
wait_time = 0.25
one_shot = true

[node name="HitArea" parent="." index="3"]
collision_layer = 64
collision_mask = 145

[node name="HitBox" parent="HitArea" index="0"]
disabled = true

[node name="CrouchBox" type="CollisionShape2D" parent="HitArea" index="1"]
position = Vector2(0, 11)
shape = SubResource("RectangleShape2D_hehew")

[node name="Sprite2D" type="Sprite2D" parent="Sprites" index="0"]
material = SubResource("ShaderMaterial_2qgdc")
texture = SubResource("CanvasTexture_acfie")
hframes = 4

[node name="BaseAnimator" parent="Animators" index="0"]
libraries = {
"RoseAnimations": ExtResource("8_r86g7")
}

[node name="CollisionShape2D" parent="Utilities/DetectOtherArea" index="0"]
visible = false
shape = SubResource("RectangleShape2D_3m3ny")

[node name="AttackCollision" parent="Utilities" index="1"]
monitoring = true
monitorable = true

[node name="CollisionShape2D" parent="Utilities/LedgeBoxL" index="0"]
position = Vector2(0, 0.5)

[node name="LedgeCastL" parent="Utilities" index="4"]
target_position = Vector2(-20, 0)
collision_mask = 1024

[node name="OpenLedgeCastL" parent="Utilities" index="5"]
target_position = Vector2(-16, 0)
collision_mask = 1024

[node name="LedgeCastR" parent="Utilities" index="6"]
target_position = Vector2(20, 0)
collision_mask = 1024

[node name="OpenLedgeCastR" parent="Utilities" index="7"]
target_position = Vector2(16, 0)
collision_mask = 1024

[node name="OpenCrouchCastR" type="RayCast2D" parent="Utilities" index="8"]
position = Vector2(0, -20)
target_position = Vector2(8, 0)
hit_from_inside = true

[node name="OpenCrouchCastL" type="RayCast2D" parent="Utilities" index="9"]
position = Vector2(0, -20)
target_position = Vector2(-8, 0)
hit_from_inside = true

[node name="CapeTarget" type="Node2D" parent="Utilities" index="10"]
position = Vector2(0, -8)

[node name="Marker2D" type="Marker2D" parent="Utilities/CapeTarget" index="0"]
z_index = -1
position = Vector2(-2, 4)

[node name="Position2D2" type="Marker2D" parent="Utilities/CapeTarget" index="1"]
z_index = -2
position = Vector2(0, 4)

[node name="Position2D3" type="Marker2D" parent="Utilities/CapeTarget" index="2"]
z_index = -3
position = Vector2(2, 4)

[node name="Position2D4" type="Marker2D" parent="Utilities/CapeTarget" index="3"]
z_index = -4
position = Vector2(4, 4)

[node name="Position2D5" type="Marker2D" parent="Utilities/CapeTarget" index="4"]
z_index = -5
position = Vector2(5, 5)

[node name="CapeInfluencers" type="Node2D" parent="Utilities" index="11"]

[node name="Marker2D" type="Marker2D" parent="Utilities/CapeInfluencers" index="0"]
position = Vector2(-25, 0)

[node name="Sprite2d2" type="Sprite2D" parent="Utilities/CapeInfluencers/Marker2D" index="0"]
modulate = Color(1, 0.886275, 0, 1)
texture = ExtResource("28_ulm3k")

[node name="WindNode" type="Marker2D" parent="Utilities" index="12"]
position = Vector2(-64, -40)
script = ExtResource("13")
wind_type = 0

[node name="Timer" type="Timer" parent="Utilities/WindNode" index="0"]

[node name="TargetReticle" parent="Utilities" index="14"]
visible = false
position = Vector2(0, 0)
script = ExtResource("27_rf1x6")

[node name="Sprite2d" type="Sprite2D" parent="Utilities/TargetReticle" index="0"]
modulate = Color(0, 0.0745098, 1, 1)
position = Vector2(64, 0)
texture = ExtResource("28_ulm3k")

[node name="SoundNode" type="Node2D" parent="Utilities" index="16"]
script = ExtResource("59_i7kba")
footsteps_dirt = Array[AudioStream]([ExtResource("60_476h5"), ExtResource("61_dobde"), ExtResource("62_83mud"), ExtResource("63_j4ffd")])
footsteps_grass = Array[AudioStream]([ExtResource("64_i7s0s"), ExtResource("65_3ctk1"), ExtResource("66_x5aat"), ExtResource("67_4crhy")])
slide_dirt = Array[AudioStream]([ExtResource("67_0lnn5"), ExtResource("68_bsyx1"), ExtResource("69_f7myh"), ExtResource("70_hi1u4")])

[node name="AudioListener2D" type="AudioListener2D" parent="." index="8"]
current = true

[connection signal="animation_changed" from="." to="MoveStates/MoveOnGround" method="_on_rose_animation_changed"]
[connection signal="footstep" from="." to="Utilities/SoundNode" method="_on_rose_footstep"]
[connection signal="landed" from="." to="MoveStates/Action" method="_on_rose_landed"]
[connection signal="silence" from="." to="Utilities/SoundNode" method="_on_rose_silence"]
[connection signal="sliding" from="." to="Utilities/SoundNode" method="_on_rose_sliding"]
[connection signal="timeout" from="MoveStates/MoveOnGround/LookTimer" to="MoveStates/MoveOnGround" method="_on_look_timer_timeout"]
[connection signal="debug_exit" from="MoveStates/Action" to="MoveStates/Action" method="_on_action_debug_exit"]
[connection signal="timeout" from="MoveStates/Crouch/LookTimer" to="MoveStates/Crouch" method="_on_look_timer_timeout"]
[connection signal="animation_finished" from="Animators/BaseAnimator" to="MoveStates/MoveOnGround" method="_on_base_animator_animation_finished"]
[connection signal="animation_finished" from="Animators/BaseAnimator" to="MoveStates/MoveInAir" method="_on_BaseAnimator_animation_finished"]
[connection signal="animation_finished" from="Animators/BaseAnimator" to="MoveStates/Action" method="_on_BaseAnimator_animation_finished"]
[connection signal="timeout" from="Utilities/WindNode/Timer" to="Utilities/WindNode" method="_on_Timer_timeout"]
